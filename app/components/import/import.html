<div class="import row" (dragover)="false" (dragleave)="false" (drop)="false">
    <div class="col">
        <div class="row">
            <div class="col default-nav bg-light text-right">
                <button id="importStartButton"
                        class="btn btn-primary"
                        [ngClass]="{ 'disabled': !isReady() }"
                        (click)="!isReady() || startImport()">
                    <span class="mdi mdi-file-import" style="color: white"></span>
                    <span i18n="@@import.startImport">Import starten</span>
                </button>
            </div>
        </div>

        <div class="row">
            <div class="form-group col default-container">
                <div class="col-lg-6 mx-lg-auto py-4">
                    <div class="form-group">
                        <label class="control-label col-form-label" for="importSourceSelect"
                               i18n="@@import.source">Quelle</label>
                        <select id="importSourceSelect" class="form-control"
                                [(ngModel)]="sourceType"
                                (ngModelChange)="reset()">
                            <option value="file" i18n="@@import.file">Datei</option>
                            <option value="http" i18n="@@import.http">HTTP</option>
                        </select>
                    </div>

                    <div *ngIf="sourceType === 'file'" class="form-group">
                        <label class="control-label col-form-label" i18n="@@import.path">Pfad</label>

                        <div class="input-group">
                            <input [ngModel]="file ? file.path : ''" class="form-control"
                                   placeholder="Datei auswählen..."
                                   i18n-placeholder="@@import.chooseFile"
                                   disabled>
                            <input id="import-file-input" class="file-input" type="file"
                                   (change)="selectFile($event)">
                            <label for="import-file-input" class="btn btn-secondary file-input-label">
                                <span class="mdi mdi-folder"></span>
                            </label>
                        </div>
                    </div>

                    <div *ngIf="sourceType === 'http'" class="form-group">
                        <label class="control-label col-form-label" i18n="@@import.url">URL</label>
                        <input class="form-control" id="importUrlInput"
                               type="text"
                               [(ngModel)]="url">
                    </div>

                    <div class="form-group">
                        <label class="control-label col-form-label"
                               for="importFormatSelect" i18n="@@import.format">Format</label>
                        <select id="importFormatSelect" class="form-control"
                                [(ngModel)]="format">
                            <option value="native" i18n="@@import.formats.native">iDAI.field – JSONL</option>
                            <option *ngIf="getProject().indexOf('test') !== -1" value="idig"
                                    i18n="@@import.formats.iDig">iDig (experimentell) – CSV</option>
                            <option value="geojson" i18n="@@import.formats.geoJson">GeoJSON – JSONL</option>
                            <option *ngIf="getProject().indexOf('meninx-project') !== -1" value="meninxfind"
                                    i18n="@@import.formats.meninx">Meninx/Funde (experimentell) – CSV</option>
                        </select>
                    </div>

                    <div *ngIf="format === 'native'" class="form-group form-check-inline">
                        <input type="checkbox" id="merging-checkbox" class="form-check-input"
                               [(ngModel)]="allowMergingExistingResources">
                        <label for="merging-checkbox" class="form-check-label" i18n="@@import.mergeOption.label">
                            Vorhandene Ressourcen ergänzen
                        </label>
                    </div>

                    <div *ngIf="format === 'native'" class="import-info" i18n="@@import.mergeOption.info">
                        Ist diese Option aktiviert, so werden bereits existierende Datensätze mit
                        den Daten aus der Importdatei ergänzt. Felder des Importdatensatzes überschreiben
                        dabei gleichnamige Felder im existierenden Datensatz, die übrigen Felder bleiben
                        jedoch erhalten. Relationen werden nicht verändert. Die Zuordnung von Datensätzen
                        geschieht per Bezeichner (Feld <em>identifier</em>). Datensätze in der Importdatei, die nicht
                        zugeordnet werden können, werden ignoriert.
                    </div>

                    <div class="form-group" *ngIf="format === 'native' && !allowMergingExistingResources">
                        <label class="control-label col-form-label"
                               for="mainTypeDocumentSelect"
                               i18n="@@import.assignToOperation.label">Daten einer Maßnahme zuordnen</label>
                        <select id="mainTypeDocumentSelect" class="form-control"
                                [(ngModel)]="mainTypeDocumentId">
                            <option value="" i18n="@@import.assignToOperation.noAssignment">Keine Zuordnung</option>
                            <option *ngFor="let document of mainTypeDocuments" value="{{document.resource.id}}">
                                {{getDocumentLabel(document)}}
                            </option>
                        </select>
                    </div>

                    <div *ngIf="format === 'geojson'" class="import-info" i18n="@@import.geoJson.info">
                        Beim GeoJSON-Import werden keine neuen Ressourcen angelegt, sondern existierenden
                        Ressourcen Geometrien hinzugefügt. Bitte beachten Sie, dass bereits vorhandene
                        Geometrien dabei überschrieben werden.
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
